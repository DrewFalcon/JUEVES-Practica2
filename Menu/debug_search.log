=== INICIO DEBUG ===
Parámetros recibidos:
from: 'UUA    '
to: 'SVO    '
max_rows: 23
Parámetros después de trim:
from: 'UUA'
to: 'SVO'
Tamaño de search.sql: 1776 bytes
Consulta SQL leída:

WITH RECURSIVE flight_paths AS (
    
    SELECT 
        f.flight_id, f.departure_airport, f.arrival_airport, f.scheduled_departure, f.scheduled_arrival,
        ARRAY[f.flight_id] AS flight_chain, (f.scheduled_arrival - f.scheduled_departure) AS total_duration, 1 AS connection_count
    FROM flights f
    WHERE f.departure_airport = ?
    AND (f.scheduled_arrival - f.scheduled_departure) < INTERVAL '24 hours'
    
    UNION ALL
    
    
    SELECT 
        f2.flight_id,
        fp.departure_airport AS original_departure,
        f2.arrival_airport,
        fp.scheduled_departure AS original_departure_time,
        f2.scheduled_arrival,
        fp.flight_chain || f2.flight_id,
        (f2.scheduled_arrival - fp.scheduled_departure) AS total_duration,
        fp.connection_count + 1
    FROM flight_paths fp
    JOIN ticket_flights tf1 ON tf1.flight_id = fp.flight_id
    JOIN tickets t ON t.ticket_no = tf1.ticket_no
    JOIN ticket_flights tf2 ON tf2.ticket_no = t.ticket_no
    JOIN flights f2 ON f2.flight_id = tf2.flight_id
    WHERE 
        f2.departure_airport = fp.arrival_airport
        AND f2.scheduled_departure >= fp.scheduled_arrival 
        AND f2.scheduled_departure <= (fp.scheduled_arrival + INTERVAL '24 hours') 
        AND f2.flight_id <> ALL(fp.flight_chain)
        AND (f2.scheduled_arrival - fp.scheduled_departure) < INTERVAL '24 hours'
        AND fp.connection_count < 3  
)
SELECT DISTINCT
    fp.flight_chain,
    fp.departure_airport AS original_departure,
    fp.arrival_airport AS final_arrival,
    fp.scheduled_departure AS original_departure_time,
    fp.scheduled_arrival AS final_arrival_time,
    fp.total_duration,
    fp.connection_count
FROM flight_paths fp
WHERE 
    fp.arrival_airport = ?
ORDER BY fp.total_duration;
Conexión ODBC exitosa
Parámetros bindeados: from='UUA', to='SVO'
Consulta ejecutada exitosamente
Fila 0: {23585}         | UUA  -> SVO  | 2017-07-31 10:35:00 | 2017-07-31 12:00:00 | 01:25:00       | 1
Fila 1: {23586}         | UUA  -> SVO  | 2017-08-29 10:35:00 | 2017-08-29 12:00:00 | 01:25:00       | 1
Fila 2: {23587}         | UUA  -> SVO  | 2017-08-08 10:35:00 | 2017-08-08 12:00:00 | 01:25:00       | 1
Fila 3: {23588}         | UUA  -> SVO  | 2017-08-24 10:35:00 | 2017-08-24 12:00:00 | 01:25:00       | 1
Fila 4: {23589}         | UUA  -> SVO  | 2017-09-07 10:35:00 | 2017-09-07 12:00:00 | 01:25:00       | 1
Fila 5: {23590}         | UUA  -> SVO  | 2017-09-06 10:35:00 | 2017-09-06 12:00:00 | 01:25:00       | 1
Fila 6: {23591}         | UUA  -> SVO  | 2017-08-09 10:35:00 | 2017-08-09 12:00:00 | 01:25:00       | 1
Fila 7: {23592}         | UUA  -> SVO  | 2017-07-21 10:35:00 | 2017-07-21 12:00:00 | 01:25:00       | 1
Fila 8: {23593}         | UUA  -> SVO  | 2017-09-09 10:35:00 | 2017-09-09 12:00:00 | 01:25:00       | 1
Fila 9: {23594}         | UUA  -> SVO  | 2017-09-14 10:35:00 | 2017-09-14 12:00:00 | 01:25:00       | 1
Fila 10: {23595}         | UUA  -> SVO  | 2017-09-12 10:35:00 | 2017-09-12 12:00:00 | 01:25:00       | 1
Fila 11: {23596}         | UUA  -> SVO  | 2017-08-21 10:35:00 | 2017-08-21 12:00:00 | 01:25:00       | 1
Fila 12: {23597}         | UUA  -> SVO  | 2017-07-27 10:35:00 | 2017-07-27 12:00:00 | 01:25:00       | 1
Fila 13: {23598}         | UUA  -> SVO  | 2017-08-16 10:35:00 | 2017-08-16 12:00:00 | 01:25:00       | 1
Fila 14: {23599}         | UUA  -> SVO  | 2017-07-20 10:35:00 | 2017-07-20 12:00:00 | 01:25:00       | 1
Fila 15: {23600}         | UUA  -> SVO  | 2017-09-08 10:35:00 | 2017-09-08 12:00:00 | 01:25:00       | 1
Fila 16: {23601}         | UUA  -> SVO  | 2017-08-03 10:35:00 | 2017-08-03 12:00:00 | 01:25:00       | 1
Fila 17: {23602}         | UUA  -> SVO  | 2017-07-16 10:35:00 | 2017-07-16 12:00:00 | 01:25:00       | 1
Fila 18: {23603}         | UUA  -> SVO  | 2017-08-02 10:35:00 | 2017-08-02 12:00:00 | 01:25:00       | 1
Fila 19: {23604}         | UUA  -> SVO  | 2017-08-01 10:35:00 | 2017-08-01 12:00:00 | 01:25:00       | 1
Fila 20: {23605}         | UUA  -> SVO  | 2017-08-15 10:35:00 | 2017-08-15 12:00:00 | 01:25:00       | 1
Fila 21: {23606}         | UUA  -> SVO  | 2017-09-02 10:35:00 | 2017-09-02 12:00:00 | 01:25:00       | 1
Fila 22: {23607}         | UUA  -> SVO  | 2017-08-30 10:35:00 | 2017-08-30 12:00:00 | 01:25:00       | 1
Total de filas obtenidas: 23
=== FIN DEBUG ===
